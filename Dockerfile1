# работает
FROM php:7.4-fpm

#git, curl, wget, grep
RUN apt-get update && apt-get install -y wget curl git grep
#RUN apt-get -y --force-yes install wget curl git unzip grep

# install composer
RUN apt-get update && apt-get install -y unzip
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/bin --filename=composer --quiet
ENV COMPOSER_ALLOW_SUPERUSER 1
#WORKDIR /app
#COPY ./composer.json ./composer.lock ./
#RUN composer install --no-dev --no-scripts --prefer-dist --optimize-autoloader

#- установленные расширения redis, memcached, pecl_http, pdo_pgsql
RUN pecl install -o -f redis xdebug \
    && rm -rf /tmp/pear \
    && docker-php-ext-enable redis xdebug



RUN apt-get update && apt-get install -y libpq-dev \
    && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \
    && docker-php-ext-install pdo_pgsql opcache
# xdebug mbstring
#
#RUN docker-php-ext-install hash iconv \
#&& pecl install raphf propro \
#&& docker-php-ext-enable raphf propro \
#&& pecl install pecl_http \
#&& echo -e "extension=raphf.so\nextension=propro.so\nextension=http.so" > /usr/local/etc/php/conf.d/docker-php-ext-http.ini \
#&& rm -rf /usr/local/etc/php/conf.d/docker-php-ext-raphf.ini \
#&& rm -rf /usr/local/etc/php/conf.d/docker-php-ext-propro.ini
